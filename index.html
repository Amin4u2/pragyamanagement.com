<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"/>
  <meta name="theme-color" content="#0a0a0f"/>
  <meta name="apple-mobile-web-app-capable" content="yes"/>
  <title>Pragya Manager</title>
  <link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet"/>
  <style>
    *,*::before,*::after{box-sizing:border-box;margin:0;padding:0;}
    :root{
      --gold:#f5a623;--gold2:#ffd166;--bg:#0a0a0f;--bg2:#111118;
      --border:#22222f;--border2:#2a2a3a;--text:#e8e4f0;
      --text2:#9994aa;--text3:#55525f;--red:#ef4444;--green:#22c55e;--blue:#3b82f6;
      --fd:'Syne',sans-serif;--fm:'JetBrains Mono',monospace;
      --r:8px;--nh:60px;
    }
    html,body,#root{height:100%;}
    body{background:var(--bg);color:var(--text);font-family:var(--fm);-webkit-font-smoothing:antialiased;overscroll-behavior:none;}
    input,select,button,textarea{font-family:var(--fm);}
    input[type=number]::-webkit-inner-spin-button{opacity:1;}
    ::-webkit-scrollbar{width:4px;height:4px;}
    ::-webkit-scrollbar-track{background:var(--bg2);}
    ::-webkit-scrollbar-thumb{background:var(--border2);border-radius:4px;}

    /* AUTH */
    .auth-wrap{min-height:100vh;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:20px;background:radial-gradient(ellipse at 50% 0%,#1a1200 0%,var(--bg) 60%);}
    .auth-logo{font-family:var(--fd);font-size:32px;font-weight:800;color:var(--gold);letter-spacing:-1px;margin-bottom:4px;}
    .auth-tagline{font-size:10px;letter-spacing:4px;color:var(--text3);margin-bottom:40px;text-transform:uppercase;}
    .auth-card{background:var(--bg2);border:1px solid var(--border);border-radius:12px;padding:32px;width:100%;max-width:400px;}
    .auth-tabs{display:flex;margin-bottom:28px;border-bottom:1px solid var(--border);}
    .auth-tab{flex:1;padding:10px;text-align:center;font-size:11px;letter-spacing:2px;text-transform:uppercase;cursor:pointer;color:var(--text3);border-bottom:2px solid transparent;transition:all .2s;}
    .auth-tab.active{color:var(--gold);border-bottom-color:var(--gold);}
    .field{margin-bottom:16px;}
    .field label{display:block;font-size:9px;letter-spacing:2px;text-transform:uppercase;color:var(--text3);margin-bottom:6px;}
    .field input{width:100%;background:var(--bg);border:1px solid var(--border2);border-radius:6px;color:var(--text);padding:12px 14px;font-size:14px;outline:none;transition:border-color .2s;}
    .field input:focus{border-color:var(--gold);}
    .auth-btn{width:100%;padding:14px;background:var(--gold);color:#0a0a0f;border:none;border-radius:6px;font-size:13px;font-weight:700;letter-spacing:2px;text-transform:uppercase;cursor:pointer;margin-top:8px;font-family:var(--fd);transition:opacity .2s;}
    .auth-btn:hover{opacity:.9;} .auth-btn:disabled{opacity:.5;cursor:not-allowed;}
    .auth-err{background:#ef444422;border:1px solid #ef444444;border-radius:6px;padding:10px 14px;font-size:11px;color:var(--red);margin-bottom:14px;}
    .auth-ok{background:#22c55e22;border:1px solid #22c55e44;border-radius:6px;padding:10px 14px;font-size:11px;color:var(--green);margin-bottom:14px;}

    /* SHELL */
    .app{display:flex;height:100vh;overflow:hidden;}
    .sidebar{width:220px;background:var(--bg2);border-right:1px solid var(--border);display:flex;flex-direction:column;flex-shrink:0;}
    .sb-logo{padding:20px 20px 18px;border-bottom:1px solid var(--border);}
    .sb-logo-main{font-family:var(--fd);font-size:18px;font-weight:800;color:var(--gold);}
    .sb-logo-sub{font-size:9px;letter-spacing:2px;color:var(--text3);margin-top:3px;line-height:1.4;}
    .nav-item{display:flex;align-items:center;gap:12px;padding:12px 20px;cursor:pointer;font-size:11px;letter-spacing:1.5px;text-transform:uppercase;color:var(--text3);border-left:2px solid transparent;transition:all .15s;}
    .nav-item.active{color:var(--gold);background:#f5a62308;border-left-color:var(--gold);}
    .nav-item:hover:not(.active){color:var(--text2);background:#ffffff04;}
    .sb-footer{margin-top:auto;padding:14px 20px;border-top:1px solid var(--border);}
    .sb-user{font-size:10px;color:var(--text3);margin-bottom:8px;} .sb-user span{color:var(--gold);}
    .logout-btn{font-size:9px;letter-spacing:2px;text-transform:uppercase;color:var(--text3);background:none;border:1px solid var(--border);border-radius:4px;padding:5px 12px;cursor:pointer;font-family:var(--fm);transition:all .15s;}
    .logout-btn:hover{color:var(--red);border-color:var(--red);}
    .main{flex:1;display:flex;flex-direction:column;overflow:hidden;}
    .topbar{padding:0 20px;height:54px;border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between;background:var(--bg2);flex-shrink:0;gap:10px;}
    .topbar-title{font-family:var(--fd);font-size:15px;font-weight:700;white-space:nowrap;}
    .topbar-actions{display:flex;gap:6px;align-items:center;flex-shrink:0;}
    .content{flex:1;overflow-y:auto;padding:20px 24px;}

    /* BOTTOM NAV (mobile) */
    .bottom-nav{display:none;position:fixed;bottom:0;left:0;right:0;background:var(--bg2);border-top:1px solid var(--border);z-index:50;height:var(--nh);}
    .bn-inner{display:flex;height:100%;}
    .bn-item{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:3px;cursor:pointer;color:var(--text3);font-size:7px;letter-spacing:1px;text-transform:uppercase;border:none;background:none;font-family:var(--fm);padding:0;}
    .bn-item.active{color:var(--gold);}
    .bn-dot{width:3px;height:3px;border-radius:50%;background:var(--gold);margin-top:1px;}

    /* PERIOD PICKER */
    .period-bar{display:flex;align-items:center;gap:8px;margin-bottom:16px;flex-wrap:wrap;padding:11px 16px;background:var(--bg2);border:1px solid var(--border);border-radius:var(--r);}
    .period-label{font-size:9px;letter-spacing:3px;text-transform:uppercase;color:var(--text3);}
    .period-sel{background:var(--bg);border:1px solid var(--gold);border-radius:6px;color:var(--gold);padding:6px 10px;font-size:12px;font-family:var(--fm);outline:none;font-weight:600;cursor:pointer;}

    /* CARDS & COMMON */
    .card{background:var(--bg2);border:1px solid var(--border);border-radius:var(--r);padding:20px;}
    .sec-title{font-size:9px;letter-spacing:3px;text-transform:uppercase;color:var(--text3);margin-bottom:16px;padding-bottom:10px;border-bottom:1px solid var(--border);}
    .stats-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin-bottom:16px;}
    .stat-card{background:var(--bg2);border:1px solid var(--border);border-radius:var(--r);padding:15px 18px;}
    .stat-label{font-size:9px;letter-spacing:2px;text-transform:uppercase;color:var(--text3);margin-bottom:6px;}
    .stat-val{font-size:20px;font-weight:700;color:var(--gold);font-family:var(--fd);line-height:1;}
    .stat-sub{font-size:10px;color:var(--text3);margin-top:4px;}
    .tbl-wrap{overflow-x:auto;-webkit-overflow-scrolling:touch;}
    table{width:100%;border-collapse:collapse;font-size:12px;min-width:460px;}
    th{padding:9px 12px;text-align:left;font-size:9px;letter-spacing:2px;text-transform:uppercase;color:var(--text3);border-bottom:1px solid var(--border);font-weight:600;white-space:nowrap;}
    td{padding:10px 12px;border-bottom:1px solid #13131a;color:var(--text2);vertical-align:middle;}
    tr:last-child td{border-bottom:none;}
    tfoot td{border-top:2px solid var(--border2);border-bottom:none;color:var(--text);font-weight:700;}
    .badge{display:inline-block;padding:2px 8px;border-radius:4px;font-size:9px;letter-spacing:1px;font-weight:700;}

    /* BUTTONS */
    .btn{padding:9px 16px;font-size:10px;letter-spacing:2px;text-transform:uppercase;background:var(--gold);color:#0a0a0f;border:none;border-radius:6px;cursor:pointer;font-weight:700;font-family:var(--fd);transition:opacity .15s;white-space:nowrap;display:inline-flex;align-items:center;gap:6px;}
    .btn:hover{opacity:.9;}
    .btn-green{background:var(--green)!important;}
    .btn-blue{background:var(--blue)!important;color:#fff!important;}
    .btn-sm{padding:5px 11px;font-size:9px;letter-spacing:1px;text-transform:uppercase;background:transparent;color:var(--gold);border:1px solid #f5a62344;border-radius:4px;cursor:pointer;font-family:var(--fm);}
    .btn-danger{padding:5px 11px;font-size:9px;background:transparent;color:var(--red);border:1px solid #ef444444;border-radius:4px;cursor:pointer;font-family:var(--fm);}
    .btn-outline{padding:7px 14px;font-size:10px;letter-spacing:1px;text-transform:uppercase;background:transparent;color:var(--text2);border:1px solid var(--border2);border-radius:6px;cursor:pointer;font-family:var(--fm);display:inline-flex;align-items:center;gap:6px;}
    .btn-outline:hover{border-color:var(--gold);color:var(--gold);}

    /* INPUTS */
    .inp{background:var(--bg);border:1px solid var(--border2);border-radius:6px;color:var(--text);padding:10px 12px;font-size:13px;font-family:var(--fm);width:100%;outline:none;transition:border-color .2s;}
    .inp:focus{border-color:var(--gold);}
    .sel{background:var(--bg);border:1px solid var(--border2);border-radius:6px;color:var(--text);padding:8px 12px;font-size:12px;font-family:var(--fm);outline:none;}
    .wk-inp{background:var(--bg);border:1px solid var(--border);border-radius:4px;color:var(--text);padding:6px 4px;font-size:12px;font-family:var(--fm);width:100%;text-align:center;outline:none;}
    .wk-inp:focus{border-color:var(--gold);}
    .lbl{font-size:9px;letter-spacing:2px;text-transform:uppercase;color:var(--text3);margin-bottom:5px;display:block;}

    /* MODAL */
    .modal-ov{position:fixed;inset:0;background:rgba(0,0,0,.88);display:flex;align-items:center;justify-content:center;z-index:200;padding:16px;}
    .modal-box{background:var(--bg2);border:1px solid var(--border2);border-radius:12px;padding:24px;width:100%;max-width:500px;max-height:92vh;overflow-y:auto;}
    .modal-lg{max-width:780px;}
    .modal-hdr{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;}
    .modal-title{font-family:var(--fd);font-size:16px;font-weight:700;}
    .modal-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px;}
    .modal-foot{display:flex;justify-content:flex-end;gap:10px;margin-top:20px;padding-top:16px;border-top:1px solid var(--border);}

    /* DRIVER CARDS */
    .drv-card{background:var(--bg2);border:1px solid var(--border);border-radius:var(--r);padding:14px;margin-bottom:10px;}
    .info-row{display:flex;gap:8px;font-size:11px;color:var(--text3);margin-top:5px;flex-wrap:wrap;}
    .prog-track{background:var(--bg);border-radius:99px;height:5px;}
    .prog-fill{background:linear-gradient(90deg,var(--gold),var(--gold2));border-radius:99px;height:5px;transition:width .4s;}
    .sales-card{background:var(--bg2);border:1px solid var(--border);border-radius:var(--r);padding:14px;margin-bottom:10px;}
    .wks-grid{display:grid;grid-template-columns:repeat(5,1fr);gap:7px;margin-top:10px;}
    .wk-box label{font-size:8px;letter-spacing:1px;color:var(--text3);margin-bottom:3px;display:block;text-align:center;}

    /* REPORT SPECIFIC */
    .report-tabs{display:flex;gap:0;margin-bottom:20px;border:1px solid var(--border);border-radius:var(--r);overflow:hidden;}
    .report-tab{flex:1;padding:10px 6px;text-align:center;font-size:10px;letter-spacing:1.5px;text-transform:uppercase;cursor:pointer;color:var(--text3);background:transparent;border:none;font-family:var(--fm);transition:all .2s;border-right:1px solid var(--border);}
    .report-tab:last-child{border-right:none;}
    .report-tab.active{color:#0a0a0f;background:var(--gold);font-weight:700;}
    .bar-row{display:flex;align-items:center;gap:10px;margin-bottom:8px;}
    .bar-label{font-size:11px;color:var(--text2);width:80px;flex-shrink:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
    .bar-track{flex:1;background:var(--bg);border-radius:4px;height:22px;position:relative;overflow:hidden;}
    .bar-fill{height:100%;border-radius:4px;transition:width .5s;display:flex;align-items:center;padding-left:8px;}
    .bar-fill span{font-size:10px;font-weight:600;color:#0a0a0f;white-space:nowrap;}
    .bar-val{font-size:11px;color:var(--gold);font-weight:700;width:90px;text-align:right;flex-shrink:0;}
    .rank-1{background:linear-gradient(90deg,var(--gold),var(--gold2));}
    .rank-2{background:linear-gradient(90deg,#9994aa,#ccc);}
    .rank-3{background:linear-gradient(90deg,#c96a1e,#e8a96a);}
    .rank-n{background:linear-gradient(90deg,#2a2a3a,#3a3a4a);}
    .kpi-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;margin-bottom:16px;}
    .kpi-card{background:var(--bg);border:1px solid var(--border2);border-radius:6px;padding:14px;}
    .kpi-label{font-size:8px;letter-spacing:2px;text-transform:uppercase;color:var(--text3);margin-bottom:5px;}
    .kpi-val{font-size:18px;font-weight:700;color:var(--gold);font-family:var(--fd);}
    .kpi-sub{font-size:10px;color:var(--text3);margin-top:3px;}
    .trend-up{color:var(--green)!important;}
    .trend-dn{color:var(--red)!important;}
    .import-zone{border:2px dashed var(--border2);border-radius:10px;padding:40px 20px;text-align:center;cursor:pointer;transition:border-color .2s;}
    .import-zone:hover,.import-zone.drag{border-color:var(--gold);background:#f5a62308;}
    .import-zone input{display:none;}
    .chip{display:inline-block;padding:3px 10px;border-radius:99px;font-size:9px;letter-spacing:1px;background:var(--bg);border:1px solid var(--border2);color:var(--text3);margin:3px 3px 0 0;}
    .chip.ok{border-color:#22c55e44;color:var(--green);background:#22c55e11;}
    .chip.warn{border-color:#f5a62344;color:var(--gold);background:#f5a62311;}
    .empty-state{text-align:center;padding:50px 20px;color:var(--text3);}
    .empty-ico{font-size:40px;margin-bottom:12px;}
    .dev-pill{display:inline-block;padding:2px 6px;background:#f5a62322;border:1px solid #f5a62355;border-radius:3px;font-size:8px;letter-spacing:1px;color:var(--gold);text-transform:uppercase;margin-left:6px;vertical-align:middle;}
    .loading{display:flex;align-items:center;justify-content:center;height:100vh;flex-direction:column;gap:12px;background:var(--bg);}
    .spinner{width:28px;height:28px;border:2px solid var(--border);border-top-color:var(--gold);border-radius:50%;animation:spin .8s linear infinite;}
    @keyframes spin{to{transform:rotate(360deg);}}
    .fade-in{animation:fadeIn .25s ease;}
    @keyframes fadeIn{from{opacity:0;transform:translateY(6px);}to{opacity:1;transform:translateY(0);}}
    .notice{padding:10px 14px;border-radius:6px;font-size:11px;margin-bottom:14px;}
    .notice-ok{background:#22c55e11;border:1px solid #22c55e33;color:var(--green);}
    .notice-warn{background:#f5a62311;border:1px solid #f5a62333;color:var(--gold);}
    .notice-err{background:#ef444411;border:1px solid #ef444433;color:var(--red);}

    @media(max-width:768px){
      .sidebar{display:none;}
      .bottom-nav{display:block;}
      .content{padding:12px 12px calc(var(--nh)+12px);}
      .topbar{padding:0 12px;height:50px;}
      .stats-grid{grid-template-columns:1fr 1fr;gap:7px;}
      .stat-val{font-size:16px;} .stat-card{padding:11px;}
      .kpi-grid{grid-template-columns:1fr 1fr;}
      .modal-grid{grid-template-columns:1fr;}
      .topbar-title{font-size:13px;}
      .hide-mob{display:none!important;}
      .report-tab{font-size:9px;padding:8px 4px;letter-spacing:1px;}
    }
    @media(max-width:420px){
      .wks-grid{gap:3px;}
      .wk-inp{font-size:10px;padding:5px 2px;}
      .kpi-grid{grid-template-columns:1fr 1fr;}
      .stats-grid{gap:5px;}
      .bar-label{width:60px;font-size:10px;}
    }
  </style>
</head>
<body>
<div id="root"><div class="loading"><div class="spinner"></div><div style="font-size:10px;letter-spacing:3px;color:var(--text3)">LOADINGâ€¦</div></div></div>

<!-- React + Babel + SheetJS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.2/babel.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

<script type="text/babel">
const {useState,useEffect,useRef}=React;
const MONTHS=["January","February","March","April","May","June","July","August","September","October","November","December"];
const CY=new Date().getFullYear();
const YEARS=Array.from({length:7},(_,i)=>(CY-3+i).toString());
const DCOLORS=["BLACK","GREEN","RED","YELLOW","BLUE","ORANGE","WHITE","PURPLE"];
const CHEX={BLACK:"#94a3b8",GREEN:"#22c55e",RED:"#ef4444",YELLOW:"#eab308",BLUE:"#3b82f6",ORANGE:"#f97316",WHITE:"#e2e8f0",PURPLE:"#a855f7"};
const DEV_U="amisco4u2", DEV_P="Amiena702$";
const DEV_DRV=[
  {id:1,color:"BLACK", name:"PHILIP", tel:"0557047868",tracker:"0248732636",reg:"M-25-AP 691",workAndPay:false,wapAmount:0},
  {id:2,color:"GREEN", name:"DOSTY",  tel:"0552396523",tracker:"0546918078",reg:"M-25-AP 784",workAndPay:false,wapAmount:0},
  {id:3,color:"RED",   name:"WANOA",  tel:"0599061621",tracker:"0593519442",reg:"M-25-AP 841",workAndPay:false,wapAmount:0},
  {id:4,color:"YELLOW",name:"KUSI",   tel:"0549355708",tracker:"0557333257",reg:"M-25-AP 785",workAndPay:false,wapAmount:0},
  {id:5,color:"BLUE",  name:"BENARD", tel:"0541120100",tracker:"0557105945",reg:"M-25-AP 859",workAndPay:false,wapAmount:0},
  {id:6,color:"GREEN", name:"TANKO",  tel:"0247738761",tracker:"0543657738",reg:"M-25-AP 794",workAndPay:true, wapAmount:88000},
];
const DEV_SALES={
  1:{"2025":{September:{1:900,2:800,3:900,4:900,5:900},October:{1:900,2:900,3:900,4:900},November:{1:900,2:900,3:900,4:900},December:{1:900,2:900,3:900,4:900,5:900}}},
  2:{"2025":{September:{1:750,2:900,3:900,4:900,5:900},October:{1:900,2:900,3:900,4:900},November:{1:900,2:900,3:900,4:900},December:{1:900,2:750,3:900,4:900,5:900}}},
  3:{"2025":{September:{1:900,2:900,3:900,4:900,5:900},October:{1:900,2:900,3:900,4:900},November:{1:900,2:900,3:900,4:900},December:{1:900,2:600,3:900,4:750,5:900}}},
  4:{"2025":{September:{1:900,2:900,3:900,4:1000,5:1200},October:{1:900,2:900,3:600,4:900},November:{1:900,2:500,3:900,4:900},December:{1:900,2:900,3:0,4:900,5:900}}},
  5:{"2025":{September:{1:900,2:900,3:900,4:900,5:900},October:{1:900,2:900,3:900,4:900},November:{1:900,2:900,3:900,4:900},December:{1:750,2:900,3:900,4:900,5:900}}},
};
const DEV_WAP={
  6:{"2025":{September:{1:1400,2:1200,3:1000,4:1200,5:1200},October:{1:1200,2:1200,3:1200,4:600},November:{1:1200,2:1200,3:1200,4:1200},December:{1:1200,2:1200,3:1200,4:1200,5:1200}}},
};

// â”€â”€ helpers â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const fmt=n=>`GHâ‚µ ${Number(n||0).toLocaleString()}`;
const fmtN=n=>Number(n||0).toLocaleString();
const sumO=o=>Object.values(o||{}).reduce((a,b)=>a+(Number(b)||0),0);
function hashStr(s){let h=0;for(let i=0;i<s.length;i++)h=(Math.imul(31,h)+s.charCodeAt(i))|0;return h.toString(36);}
function lsSet(k,v){try{localStorage.setItem(k,JSON.stringify(v));}catch(e){}}
function lsGet(k){try{const r=localStorage.getItem(k);return r?JSON.parse(r):null;}catch(e){return null;}}
function pct(v,max){return max>0?Math.min(100,(v/max)*100):0;}

function bootstrap(){
  const users=lsGet("pg-users")||{};
  if(!users[DEV_U]){users[DEV_U]={hash:hashStr(DEV_P),business:"Pragya Transport (Dev)",isDev:true,created:0};lsSet("pg-users",users);}
  if(!lsGet(`${DEV_U}-drivers`))lsSet(`${DEV_U}-drivers`,DEV_DRV);
  if(!lsGet(`${DEV_U}-sales`))  lsSet(`${DEV_U}-sales`,DEV_SALES);
  if(!lsGet(`${DEV_U}-wap`))    lsSet(`${DEV_U}-wap`,DEV_WAP);
}
bootstrap();

// â”€â”€ icons â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const PX={
  dashboard:"M4 5a1 1 0 011-1h4a1 1 0 011 1v5a1 1 0 01-1 1H5a1 1 0 01-1-1V5zm10 0a1 1 0 011-1h4a1 1 0 011 1v2a1 1 0 01-1 1h-4a1 1 0 01-1-1V5zm0 7a1 1 0 011-1h4a1 1 0 011 1v5a1 1 0 01-1 1h-4a1 1 0 01-1-1v-5zM4 13a1 1 0 011-1h4a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1v-2z",
  drivers:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z",
  sales:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z",
  wap:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z",
  report:"M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z",
  transfer:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12",
  plus:"M12 4v16m8-8H4",
  edit:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z",
  trash:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16",
  x:"M6 18L18 6M6 6l12 12",
  logout:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1",
  eye:"M15 12a3 3 0 11-6 0 3 3 0 016 0z M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z",
  cal:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z",
  download:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4",
  upload:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12",
};
function Ic({name,size=16,color="currentColor"}){
  return <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="1.8" strokeLinecap="round" strokeLinejoin="round"><path d={PX[name]}/></svg>;
}
function CDot({color}){return <div style={{width:9,height:9,borderRadius:"50%",background:CHEX[color]||"#888",flexShrink:0}}/>;}
function CBadge({color}){const h=CHEX[color]||"#888";return <span className="badge" style={{background:h+"22",color:color==="BLACK"?"#94a3b8":h,border:`1px solid ${h}44`}}>{color}</span>;}

// â”€â”€ Period Picker â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function PeriodPicker({year,month,setYear,setMonth,label="PERIOD"}){
  return(
    <div className="period-bar">
      <Ic name="cal" size={13} color="var(--gold)"/>
      <span className="period-label">{label}</span>
      <select className="period-sel" value={year} onChange={e=>setYear(e.target.value)}>
        {YEARS.map(y=><option key={y}>{y}</option>)}
      </select>
      <select className="period-sel" value={month} onChange={e=>setMonth(e.target.value)}>
        {MONTHS.map(m=><option key={m}>{m}</option>)}
      </select>
    </div>
  );
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  EXCEL EXPORT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function exportToExcel(drivers,sales,wap,business){
  const wb=XLSX.utils.book_new();
  const gold="FF F5A623";
  const hdr={font:{bold:true,color:{rgb:"000000"}},fill:{fgColor:{rgb:"F5A623"}},alignment:{horizontal:"center"}};
  const hdr2={font:{bold:true,color:{rgb:"F5A623"}},fill:{fgColor:{rgb:"111118"}}};

  // â”€â”€ Sheet 1: Drivers â”€â”€
  const dRows=[["#","NAME","COLOR","TEL","TRACKER","REG NO.","TYPE","W&P AMOUNT"]];
  drivers.forEach((d,i)=>dRows.push([i+1,d.name,d.color,d.tel,d.tracker,d.reg,d.workAndPay?"WORK & PAY":"REGULAR",d.workAndPay?d.wapAmount:""]));
  const ws1=XLSX.utils.aoa_to_sheet(dRows);
  ws1["!cols"]=[{wch:4},{wch:14},{wch:9},{wch:14},{wch:14},{wch:14},{wch:12},{wch:14}];
  XLSX.utils.book_append_sheet(wb,ws1,"Drivers");

  // â”€â”€ Sheet 2: Sales by Month (all years) â”€â”€
  const regD=drivers.filter(d=>!d.workAndPay);
  const allYears=[...new Set(Object.values(sales).flatMap(y=>Object.keys(y)))].sort();
  const sRows=[["DRIVER","YEAR","MONTH","WEEK 1","WEEK 2","WEEK 3","WEEK 4","WEEK 5","MONTH TOTAL"]];
  regD.forEach(d=>{
    allYears.forEach(yr=>{
      MONTHS.forEach(m=>{
        const wks=((sales[d.id]||{})[yr]||{})[m]||{};
        const tot=sumO(wks);
        if(!tot)return;
        sRows.push([d.name,yr,m,wks[1]||0,wks[2]||0,wks[3]||0,wks[4]||0,wks[5]||0,tot]);
      });
    });
  });
  // Summary rows
  sRows.push([]);
  sRows.push(["YEAR SUMMARY","","","","","","","",""]);
  allYears.forEach(yr=>{
    MONTHS.forEach(m=>{
      const yrMthTotal=regD.reduce((t,d)=>t+sumO(((sales[d.id]||{})[yr]||{})[m]||{}),0);
      if(!yrMthTotal)return;
      sRows.push([`ALL DRIVERS`,yr,m,"","","","","",yrMthTotal]);
    });
  });
  const ws2=XLSX.utils.aoa_to_sheet(sRows);
  ws2["!cols"]=[{wch:14},{wch:6},{wch:11},{wch:8},{wch:8},{wch:8},{wch:8},{wch:8},{wch:12}];
  XLSX.utils.book_append_sheet(wb,ws2,"Sales");

  // â”€â”€ Sheet 3: Monthly Summary pivot â”€â”€
  const pivRows=[["DRIVER",...MONTHS,"YEAR TOTAL"]];
  const pivYr=allYears[allYears.length-1]||CY.toString();
  regD.forEach(d=>{
    const row=[d.name];
    let yr_t=0;
    MONTHS.forEach(m=>{const mt=sumO(((sales[d.id]||{})[pivYr]||{})[m]||{});row.push(mt||0);yr_t+=mt;});
    row.push(yr_t);
    pivRows.push(row);
  });
  // Totals row
  const totRow=["TOTAL"];
  MONTHS.forEach(m=>{totRow.push(regD.reduce((t,d)=>t+sumO(((sales[d.id]||{})[pivYr]||{})[m]||{}),0));});
  totRow.push(regD.reduce((t,d)=>t+MONTHS.reduce((mt,m)=>mt+sumO(((sales[d.id]||{})[pivYr]||{})[m]||{}),0),0));
  pivRows.push(totRow);
  const ws3=XLSX.utils.aoa_to_sheet(pivRows);
  ws3["!cols"]=[{wch:14},...MONTHS.map(()=>({wch:9})),{wch:11}];
  XLSX.utils.book_append_sheet(wb,ws3,`${pivYr} Summary`);

  // â”€â”€ Sheet 4: Work & Pay â”€â”€
  const wapD=drivers.filter(d=>d.workAndPay);
  const wRows=[["DRIVER","YEAR","MONTH","WK1","WK2","WK3","WK4","WK5","MONTH PAID","CUMULATIVE PAID","REMAINING BALANCE"]];
  wapD.forEach(d=>{
    let cum=0;
    Object.keys(wap[d.id]||{}).sort().forEach(yr=>{
      MONTHS.forEach(m=>{
        const mw=((wap[d.id]||{})[yr]||{})[m]||{};
        const mp=sumO(mw);
        if(!mp)return;
        cum+=mp;
        wRows.push([d.name,yr,m,mw[1]||0,mw[2]||0,mw[3]||0,mw[4]||0,mw[5]||0,mp,cum,d.wapAmount-cum]);
      });
    });
  });
  const ws4=XLSX.utils.aoa_to_sheet(wRows);
  ws4["!cols"]=[{wch:12},{wch:6},{wch:11},{wch:7},{wch:7},{wch:7},{wch:7},{wch:7},{wch:11},{wch:15},{wch:18}];
  XLSX.utils.book_append_sheet(wb,ws4,"Work & Pay");

  const date=new Date().toISOString().slice(0,10);
  XLSX.writeFile(wb,`Pragya_Report_${business.replace(/\s+/g,"_")}_${date}.xlsx`);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  AUTH
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function Auth({onLogin}){
  const [tab,setTab]=useState("signin");
  const [f,setF]=useState({u:"",p:"",c:"",b:""});
  const [err,setErr]=useState("");const [ok,setOk]=useState("");
  const [busy,setBusy]=useState(false);const [showP,setShowP]=useState(false);
  const sv=(k,v)=>setF(p=>({...p,[k]:v}));

  function doSignIn(){
    setErr("");setBusy(true);
    const users=lsGet("pg-users")||{};
    const ukey=f.u.toLowerCase().trim();
    const usr=users[ukey];
    if(!usr){setErr("Account not found. Please sign up.");setBusy(false);return;}
    if(usr.hash!==hashStr(f.p)){setErr("Incorrect password.");setBusy(false);return;}
    const sess={username:ukey,business:usr.business,isDev:!!usr.isDev};
    lsSet("pg-session",sess);onLogin(sess);setBusy(false);
  }
  function doSignUp(){
    setErr("");setBusy(true);
    const ukey=f.u.toLowerCase().trim();
    if(!ukey||!f.p||!f.b.trim()){setErr("All fields are required.");setBusy(false);return;}
    if(ukey===DEV_U){setErr("That username is reserved.");setBusy(false);return;}
    if(f.p.length<6){setErr("Password must be at least 6 characters.");setBusy(false);return;}
    if(f.p!==f.c){setErr("Passwords do not match.");setBusy(false);return;}
    const users=lsGet("pg-users")||{};
    if(users[ukey]){setErr("Username already taken.");setBusy(false);return;}
    users[ukey]={hash:hashStr(f.p),business:f.b.trim(),isDev:false,created:Date.now()};
    lsSet("pg-users",users);
    lsSet(`${ukey}-drivers`,[]);lsSet(`${ukey}-sales`,{});lsSet(`${ukey}-wap`,{});
    setOk("Account created! Signing you inâ€¦");
    setTimeout(()=>{const sess={username:ukey,business:f.b.trim(),isDev:false};lsSet("pg-session",sess);onLogin(sess);},900);
    setBusy(false);
  }
  return(
    <div className="auth-wrap fade-in">
      <div className="auth-logo">ğŸ›º PRAGYA</div>
      <div className="auth-tagline">Business Management System</div>
      <div className="auth-card">
        <div className="auth-tabs">
          {[["signin","Sign In"],["signup","Sign Up"]].map(([t,l])=>(
            <div key={t} className={`auth-tab${tab===t?" active":""}`} onClick={()=>{setTab(t);setErr("");setOk("");}}>
              {l}
            </div>
          ))}
        </div>
        {err&&<div className="auth-err">âš  {err}</div>}
        {ok&&<div className="auth-ok">âœ“ {ok}</div>}
        {tab==="signup"&&<div className="field"><label>Business Name</label><input placeholder="e.g. Pragya Transport Kumasi" value={f.b} onChange={e=>sv("b",e.target.value)}/></div>}
        <div className="field"><label>Username</label><input placeholder="your username" value={f.u} onChange={e=>sv("u",e.target.value)} autoComplete="username"/></div>
        <div className="field">
          <label>Password</label>
          <div style={{position:"relative"}}>
            <input type={showP?"text":"password"} placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" value={f.p} onChange={e=>sv("p",e.target.value)} style={{paddingRight:42}} autoComplete={tab==="signin"?"current-password":"new-password"}/>
            <button onClick={()=>setShowP(p=>!p)} style={{position:"absolute",right:10,top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",color:"var(--text3)",padding:2}}><Ic name="eye" size={14}/></button>
          </div>
        </div>
        {tab==="signup"&&<div className="field"><label>Confirm Password</label><input type="password" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" value={f.c} onChange={e=>sv("c",e.target.value)} autoComplete="new-password"/></div>}
        <button className="auth-btn" onClick={tab==="signin"?doSignIn:doSignUp} disabled={busy}>
          {busy?"Please waitâ€¦":tab==="signin"?"Sign In â†’":"Create Account â†’"}
        </button>
        {tab==="signin"&&<p style={{textAlign:"center",fontSize:10,color:"var(--text3)",marginTop:12}}>No account? <span style={{color:"var(--gold)",cursor:"pointer"}} onClick={()=>{setTab("signup");setErr("");}}>Sign up free</span></p>}
      </div>
    </div>
  );
}

// â”€â”€ Root â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function App(){
  const [sess,setSess]=useState(null);const [ready,setReady]=useState(false);
  useEffect(()=>{bootstrap();const s=lsGet("pg-session");setSess(s);setReady(true);},[]);
  const login=u=>{lsSet("pg-session",u);setSess(u);};
  const logout=()=>{lsSet("pg-session",null);setSess(null);};
  if(!ready)return<div className="loading"><div className="spinner"/><div style={{fontSize:10,letterSpacing:3,color:"var(--text3)"}}>LOADINGâ€¦</div></div>;
  if(!sess)return<Auth onLogin={login}/>;
  return<Dashboard session={sess} onLogout={logout}/>;
}

// â”€â”€ Dashboard â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function Dashboard({session,onLogout}){
  const u=session.username;
  const [view,setView]=useState("dashboard");
  const [drivers,setDrivers]=useState(()=>lsGet(`${u}-drivers`)||[]);
  const [sales,setSales]=useState(()=>lsGet(`${u}-sales`)||{});
  const [wap,setWap]=useState(()=>lsGet(`${u}-wap`)||{});
  const [modal,setModal]=useState(null);
  const [selYear,setSelYear]=useState(CY.toString());
  const [selMonth,setSelMonth]=useState(MONTHS[new Date().getMonth()]);
  const [importModal,setImportModal]=useState(false);
  const [importMsg,setImportMsg]=useState(null);

  useEffect(()=>lsSet(`${u}-drivers`,drivers),[drivers]);
  useEffect(()=>lsSet(`${u}-sales`,sales),[sales]);
  useEffect(()=>lsSet(`${u}-wap`,wap),[wap]);

  const updSale=(did,yr,mo,wk,val)=>setSales(p=>({...p,[did]:{...(p[did]||{}),[yr]:{...((p[did]||{})[yr]||{}),[mo]:{...((p[did]||{})[yr]||{})[mo]||{},[wk]:Number(val)||0}}}}));
  const updWap=(did,yr,mo,wk,val)=>setWap(p=>({...p,[did]:{...(p[did]||{}),[yr]:{...((p[did]||{})[yr]||{}),[mo]:{...((p[did]||{})[yr]||{})[mo]||{},[wk]:Number(val)||0}}}}));
  const saveDrv=d=>{
    if(d.id)setDrivers(p=>p.map(x=>x.id===d.id?d:x));
    else{const nid=drivers.length?Math.max(...drivers.map(x=>x.id))+1:1;setDrivers(p=>[...p,{...d,id:nid}]);}
    setModal(null);
  };
  const delDrv=id=>{
    if(!window.confirm("Delete this driver and all their data?"))return;
    setDrivers(p=>p.filter(d=>d.id!==id));
    setSales(p=>{const n={...p};delete n[id];return n;});
    setWap(p=>{const n={...p};delete n[id];return n;});
  };

  // â”€â”€ Excel Import logic â”€â”€
  function handleImport(file){
    const reader=new FileReader();
    reader.onload=e=>{
      try{
        const wb=XLSX.read(e.target.result,{type:"array"});
        let imported={drivers:null,sales:null,wap:null};
        let msgs=[];

        // Import Drivers sheet
        if(wb.SheetNames.includes("Drivers")){
          const rows=XLSX.utils.sheet_to_json(wb.Sheets["Drivers"],{header:1}).slice(1);
          const newDrvs=rows.filter(r=>r[1]).map((r,i)=>({
            id:i+1,name:String(r[1]||"").toUpperCase(),color:String(r[2]||"BLACK").toUpperCase(),
            tel:String(r[3]||""),tracker:String(r[4]||""),reg:String(r[5]||""),
            workAndPay:String(r[6]||"").includes("WORK"),
            wapAmount:Number(r[7])||0
          }));
          if(newDrvs.length){imported.drivers=newDrvs;msgs.push(`âœ“ ${newDrvs.length} drivers`);}
        }

        // Import Sales sheet
        if(wb.SheetNames.includes("Sales")){
          const rows=XLSX.utils.sheet_to_json(wb.Sheets["Sales"],{header:1}).slice(1);
          const newSales={};
          const drvList=imported.drivers||drivers;
          rows.forEach(r=>{
            if(!r[0]||!r[1]||!r[2])return;
            const dName=String(r[0]).toUpperCase().trim();
            const yr=String(r[1]).trim();
            const mo=String(r[2]).trim();
            if(!MONTHS.includes(mo))return;
            const drv=drvList.find(d=>d.name===dName);
            if(!drv)return;
            const did=drv.id;
            if(!newSales[did])newSales[did]={};
            if(!newSales[did][yr])newSales[did][yr]={};
            newSales[did][yr][mo]={1:Number(r[3])||0,2:Number(r[4])||0,3:Number(r[5])||0,4:Number(r[6])||0,5:Number(r[7])||0};
          });
          if(Object.keys(newSales).length){imported.sales=newSales;msgs.push(`âœ“ Sales data`);}
        }

        // Import Work & Pay sheet
        if(wb.SheetNames.includes("Work & Pay")){
          const rows=XLSX.utils.sheet_to_json(wb.Sheets["Work & Pay"],{header:1}).slice(1);
          const newWap={};
          const drvList=imported.drivers||drivers;
          rows.forEach(r=>{
            if(!r[0]||!r[1]||!r[2])return;
            const dName=String(r[0]).toUpperCase().trim();
            const yr=String(r[1]).trim();
            const mo=String(r[2]).trim();
            if(!MONTHS.includes(mo))return;
            const drv=drvList.find(d=>d.name===dName&&d.workAndPay);
            if(!drv)return;
            const did=drv.id;
            if(!newWap[did])newWap[did]={};
            if(!newWap[did][yr])newWap[did][yr]={};
            newWap[did][yr][mo]={1:Number(r[3])||0,2:Number(r[4])||0,3:Number(r[5])||0,4:Number(r[6])||0,5:Number(r[7])||0};
          });
          if(Object.keys(newWap).length){imported.wap=newWap;msgs.push(`âœ“ W&P payments`);}
        }

        if(msgs.length===0){setImportMsg({type:"err",text:"No recognized data found. Make sure you're importing a file exported from Pragya Manager."});return;}
        if(imported.drivers)setDrivers(imported.drivers);
        if(imported.sales)  setSales(imported.sales);
        if(imported.wap)    setWap(imported.wap);
        setImportMsg({type:"ok",text:`Import successful: ${msgs.join(", ")}.`});
        setTimeout(()=>{setImportModal(false);setImportMsg(null);},2200);
      }catch(err){
        setImportMsg({type:"err",text:"Failed to read file. Make sure it's a valid .xlsx file."});
      }
    };
    reader.readAsArrayBuffer(file);
  }

  const regD=drivers.filter(d=>!d.workAndPay);
  const wapD=drivers.filter(d=>d.workAndPay);
  const periodSales=regD.reduce((t,d)=>t+sumO(((sales[d.id]||{})[selYear]||{})[selMonth]||{}),0);
  const yearSales=regD.reduce((t,d)=>t+MONTHS.reduce((mt,m)=>mt+sumO(((sales[d.id]||{})[selYear]||{})[m]||{}),0),0);
  const totOwed=wapD.reduce((t,d)=>t+d.wapAmount,0);
  const totWapPaid=Object.values(wap).reduce((t,yrs)=>t+Object.values(yrs||{}).reduce((yt,mos)=>yt+Object.values(mos||{}).reduce((mt,wks)=>mt+sumO(wks),0),0),0);
  const wapBal=totOwed-totWapPaid;

  const NAV=[
    {id:"dashboard",label:"Home",icon:"dashboard"},
    {id:"drivers",label:"Drivers",icon:"drivers"},
    {id:"sales",label:"Sales",icon:"sales"},
    {id:"workpay",label:"W&P",icon:"wap"},
    {id:"reports",label:"Reports",icon:"report"},
    {id:"transfer",label:"Data",icon:"transfer"},
  ];
  const period={selYear,selMonth,setSelYear,setSelMonth};

  return(
    <div className="app">
      <aside className="sidebar">
        <div className="sb-logo">
          <div className="sb-logo-main">ğŸ›º Pragya</div>
          <div className="sb-logo-sub">{session.business}{session.isDev&&<span className="dev-pill">DEV</span>}</div>
        </div>
        <nav style={{padding:"6px 0",flex:1}}>
          {NAV.map(n=>(
            <div key={n.id} className={`nav-item${view===n.id?" active":""}`} onClick={()=>setView(n.id)}>
              <Ic name={n.icon} size={13} color={view===n.id?"var(--gold)":"var(--text3)"}/>
              {n.label}
            </div>
          ))}
        </nav>
        <div className="sb-footer">
          <div className="sb-user">@<span>{u}</span></div>
          <button className="logout-btn" onClick={onLogout}><Ic name="logout" size={10}/> Sign Out</button>
        </div>
      </aside>

      <div className="main">
        <div className="topbar">
          <div className="topbar-title">{NAV.find(n=>n.id===view)?.label}</div>
          <div className="topbar-actions">
            {view==="drivers"&&<button className="btn" onClick={()=>setModal({type:"add"})}><Ic name="plus" size={12} color="#0a0a0f"/>Add Driver</button>}
            {view==="reports"&&<button className="btn" onClick={()=>exportToExcel(drivers,sales,wap,session.business)}><Ic name="download" size={12} color="#0a0a0f"/>Export Excel</button>}
            {view==="transfer"&&<button className="btn btn-blue" onClick={()=>setImportModal(true)}><Ic name="upload" size={12}/>Import Excel</button>}
            <button className="btn-outline hide-mob" onClick={onLogout} style={{padding:"6px 10px"}}><Ic name="logout" size={13}/></button>
          </div>
        </div>

        <div className="content fade-in">
          {view==="dashboard"&&<VDash regD={regD} wapD={wapD} periodSales={periodSales} yearSales={yearSales} wapBal={wapBal} totOwed={totOwed} sales={sales} {...period}/>}
          {view==="drivers"  &&<VDrivers drivers={drivers} setModal={setModal} delDrv={delDrv}/>}
          {view==="sales"    &&<VSales regD={regD} sales={sales} updSale={updSale} {...period}/>}
          {view==="workpay"  &&<VWap wapD={wapD} wap={wap} updWap={updWap} {...period}/>}
          {view==="reports"  &&<VReports regD={regD} wapD={wapD} drivers={drivers} sales={sales} wap={wap} {...period} onExport={()=>exportToExcel(drivers,sales,wap,session.business)}/>}
          {view==="transfer" &&<VTransfer drivers={drivers} sales={sales} wap={wap} session={session} onExport={()=>exportToExcel(drivers,sales,wap,session.business)} onImport={()=>setImportModal(true)}/>}
        </div>
      </div>

      {/* Mobile Bottom Nav â€” 5 items, show first 5 */}
      <nav className="bottom-nav">
        <div className="bn-inner">
          {NAV.slice(0,5).map(n=>(
            <button key={n.id} className={`bn-item${view===n.id?" active":""}`} onClick={()=>setView(n.id)}>
              <Ic name={n.icon} size={20} color={view===n.id?"var(--gold)":"var(--text3)"}/>
              {n.label}
              {view===n.id&&<div className="bn-dot"/>}
            </button>
          ))}
        </div>
      </nav>

      {modal&&<DrvModal driver={modal.data||null} onSave={saveDrv} onClose={()=>setModal(null)}/>}
      {importModal&&<ImportModal onFile={handleImport} msg={importMsg} onClose={()=>{setImportModal(false);setImportMsg(null);}}/>}
    </div>
  );
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  VIEW: DASHBOARD
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function VDash({regD,wapD,periodSales,yearSales,wapBal,totOwed,sales,selYear,selMonth,setSelYear,setSelMonth}){
  const maxP=regD.reduce((mx,d)=>Math.max(mx,sumO(((sales[d.id]||{})[selYear]||{})[selMonth]||{})),1);
  return(
    <div>
      <PeriodPicker year={selYear} month={selMonth} setYear={setSelYear} setMonth={setSelMonth} label="VIEWING"/>
      <div className="stats-grid">
        <div className="stat-card"><div className="stat-label">Drivers</div><div className="stat-val">{regD.length+wapD.length}</div><div className="stat-sub">{regD.length} regular Â· {wapD.length} W&P</div></div>
        <div className="stat-card"><div className="stat-label">{selMonth.slice(0,3)} {selYear}</div><div className="stat-val">{fmt(periodSales)}</div><div className="stat-sub">period sales</div></div>
        <div className="stat-card"><div className="stat-label">{selYear} Total</div><div className="stat-val">{fmt(yearSales)}</div><div className="stat-sub">full year</div></div>
        <div className="stat-card"><div className="stat-label">W&P Balance</div><div className="stat-val" style={{color:wapBal<=0?"var(--green)":"var(--gold)"}}>{fmt(wapBal)}</div><div className="stat-sub">of {fmt(totOwed)}</div></div>
      </div>
      <div className="card" style={{marginBottom:14}}>
        <div className="sec-title">{selYear} â€” Monthly Totals</div>
        <div style={{display:"flex",gap:7,overflowX:"auto",paddingBottom:4}}>
          {MONTHS.map(m=>{
            const t=regD.reduce((tt,d)=>tt+sumO(((sales[d.id]||{})[selYear]||{})[m]||{}),0);
            if(!t&&m!==selMonth)return null;
            const sel=m===selMonth;
            return(
              <div key={m} onClick={()=>setSelMonth(m)} style={{cursor:"pointer",background:sel?"var(--gold)":"var(--bg)",border:`1px solid ${sel?"var(--gold)":"var(--border)"}`,borderRadius:8,padding:"10px 14px",flexShrink:0,transition:"all .2s",minWidth:70}}>
                <div style={{fontSize:8,letterSpacing:2,color:sel?"#0a0a0f":"var(--text3)",marginBottom:3}}>{m.slice(0,3).toUpperCase()}</div>
                <div style={{fontSize:13,fontWeight:700,color:sel?"#0a0a0f":"var(--gold)",fontFamily:"var(--fd)"}}>{t>0?fmt(t):"â€”"}</div>
              </div>
            );
          })}
        </div>
      </div>
      {regD.length===0
        ?<div className="card empty-state"><div className="empty-ico">ğŸ›º</div><div style={{fontSize:12,letterSpacing:2}}>NO DRIVERS YET</div><div style={{fontSize:11,marginTop:8}}>Go to Drivers tab to add your first driver</div></div>
        :<div className="card">
          <div className="sec-title">Leaderboard â€” {selMonth} {selYear}</div>
          {[...regD].map(d=>({...d,total:sumO(((sales[d.id]||{})[selYear]||{})[selMonth]||{})}))
            .sort((a,b)=>b.total-a.total).map((d,i)=>(
            <div key={d.id} style={{display:"flex",alignItems:"center",gap:10,padding:"9px 0",borderBottom:"1px solid var(--border)"}}>
              <div style={{fontSize:11,color:"var(--text3)",width:16,textAlign:"center",fontWeight:700}}>{i+1}</div>
              <CDot color={d.color}/>
              <div style={{flex:1}}>
                <div style={{fontSize:12,fontWeight:600,marginBottom:3}}>{d.name}</div>
                <div className="prog-track"><div className="prog-fill" style={{width:`${pct(d.total,maxP)}%`}}/></div>
              </div>
              <div style={{fontSize:13,fontWeight:700,color:d.total>0?"var(--gold)":"var(--text3)",minWidth:88,textAlign:"right"}}>{fmt(d.total)}</div>
            </div>
          ))}
        </div>
      }
    </div>
  );
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  VIEW: DRIVERS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function VDrivers({drivers,setModal,delDrv}){
  if(!drivers.length)return(
    <div className="card empty-state">
      <div className="empty-ico">ğŸ‘¤</div><div style={{fontSize:12,letterSpacing:2}}>NO DRIVERS YET</div>
      <div style={{fontSize:11,marginTop:8,marginBottom:18}}>Add your first Pragya driver to get started</div>
      <button className="btn" onClick={()=>setModal({type:"add"})}>+ Add First Driver</button>
    </div>
  );
  return(
    <div>
      <div className="card hide-mob">
        <div className="sec-title">All Drivers ({drivers.length})</div>
        <div className="tbl-wrap">
          <table>
            <thead><tr><th>#</th><th>Color</th><th>Name</th><th>Tel</th><th>Tracker</th><th>Reg No.</th><th>Type</th><th>W&P Amt</th><th></th></tr></thead>
            <tbody>
              {drivers.map((d,i)=>(
                <tr key={d.id}>
                  <td style={{color:"var(--text3)"}}>{i+1}</td><td><CBadge color={d.color}/></td>
                  <td style={{fontWeight:600,color:"var(--text)"}}>{d.name}</td><td>{d.tel}</td>
                  <td style={{color:"var(--text3)"}}>{d.tracker}</td><td style={{color:"var(--gold)",opacity:.8}}>{d.reg}</td>
                  <td><span style={{fontSize:9,color:d.workAndPay?"var(--gold)":"var(--text3)"}}>{d.workAndPay?"WORK & PAY":"REGULAR"}</span></td>
                  <td>{d.workAndPay?fmt(d.wapAmount):"â€”"}</td>
                  <td><div style={{display:"flex",gap:5}}>
                    <button className="btn-sm" onClick={()=>setModal({type:"edit",data:d})}>Edit</button>
                    <button className="btn-danger" onClick={()=>delDrv(d.id)}>Del</button>
                  </div></td>
                </tr>
              ))}
            </tbody>
          </table>
        </div>
      </div>
      <div>
        {drivers.map(d=>(
          <div key={d.id} className="drv-card">
            <div style={{display:"flex",justifyContent:"space-between",alignItems:"flex-start"}}>
              <div>
                <div style={{display:"flex",alignItems:"center",gap:8,marginBottom:3}}>
                  <CDot color={d.color}/>
                  <span style={{fontFamily:"var(--fd)",fontWeight:700,fontSize:14}}>{d.name}</span>
                  {d.workAndPay&&<span style={{fontSize:8,color:"var(--gold)",background:"#f5a62322",padding:"2px 6px",borderRadius:3}}>W&P</span>}
                </div>
                <div className="info-row"><span>ğŸ“± {d.tel}</span><span>ğŸ·ï¸ {d.reg}</span></div>
                {d.workAndPay&&<div style={{fontSize:11,color:"var(--gold)",marginTop:3}}>Owed: {fmt(d.wapAmount)}</div>}
              </div>
              <div style={{display:"flex",gap:5,flexShrink:0}}>
                <button className="btn-sm" onClick={()=>setModal({type:"edit",data:d})}><Ic name="edit" size={12}/></button>
                <button className="btn-danger" onClick={()=>delDrv(d.id)}><Ic name="trash" size={12}/></button>
              </div>
            </div>
          </div>
        ))}
      </div>
      <button className="btn" style={{marginTop:12,width:"100%"}} onClick={()=>setModal({type:"add"})}>+ Add New Driver</button>
    </div>
  );
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  VIEW: SALES
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function VSales({regD,sales,updSale,selYear,selMonth,setSelYear,setSelMonth}){
  const total=regD.reduce((t,d)=>t+sumO(((sales[d.id]||{})[selYear]||{})[selMonth]||{}),0);
  if(!regD.length)return<div className="card empty-state"><div className="empty-ico">ğŸ“Š</div><div style={{fontSize:12,letterSpacing:2}}>NO DRIVERS</div><div style={{fontSize:11,marginTop:8}}>Add drivers first</div></div>;
  return(
    <div>
      <PeriodPicker year={selYear} month={selMonth} setYear={setSelYear} setMonth={setSelMonth} label="ENTERING SALES FOR"/>
      <div style={{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12,padding:"10px 16px",background:"var(--bg2)",border:"1px solid var(--border)",borderRadius:8}}>
        <div style={{fontSize:10,color:"var(--text3)",letterSpacing:2}}>EDIT ANY WEEK Â· GHâ‚µ</div>
        <div style={{fontSize:14,fontWeight:700,color:"var(--gold)"}}>{selMonth} {selYear}: {fmt(total)}</div>
      </div>
      {regD.map(d=>{
        const wks=((sales[d.id]||{})[selYear]||{})[selMonth]||{};
        const t=sumO(wks);
        return(
          <div key={d.id} className="sales-card">
            <div style={{display:"flex",justifyContent:"space-between",alignItems:"center"}}>
              <div style={{display:"flex",alignItems:"center",gap:8}}><CDot color={d.color}/><span style={{fontWeight:700,fontFamily:"var(--fd)"}}>{d.name}</span></div>
              <div style={{fontSize:14,fontWeight:700,color:t>0?"var(--gold)":"var(--text3)"}}>{fmt(t)}</div>
            </div>
            <div className="wks-grid">
              {[1,2,3,4,5].map(w=>(
                <div key={w} className="wk-box">
                  <label>Wk {w}</label>
                  <input type="number" className="wk-inp" value={wks[w]||""} placeholder="0" onChange={e=>updSale(d.id,selYear,selMonth,w,e.target.value)}/>
                </div>
              ))}
            </div>
          </div>
        );
      })}
      <div className="card" style={{marginTop:12}}>
        <div className="sec-title">{selYear} â€” Year Overview</div>
        <div className="tbl-wrap">
          <table>
            <thead><tr><th>Driver</th>{MONTHS.map(m=><th key={m} style={{textAlign:"center",fontSize:8}}>{m.slice(0,3)}</th>)}<th style={{textAlign:"right"}}>{selYear}</th></tr></thead>
            <tbody>
              {regD.map(d=>{
                const yr=MONTHS.reduce((t,m)=>t+sumO(((sales[d.id]||{})[selYear]||{})[m]||{}),0);
                return(
                  <tr key={d.id}>
                    <td style={{fontWeight:600,whiteSpace:"nowrap"}}>{d.name}</td>
                    {MONTHS.map(m=>{const mt=sumO(((sales[d.id]||{})[selYear]||{})[m]||{});return<td key={m} style={{textAlign:"center",fontSize:11,color:m===selMonth?"var(--gold)":mt>0?"var(--text2)":"var(--text3)",background:m===selMonth?"#f5a62308":""}}>{mt>0?mt.toLocaleString():"â€”"}</td>;})}
                    <td style={{textAlign:"right",fontWeight:700,color:yr>0?"var(--gold)":"var(--text3)",whiteSpace:"nowrap"}}>{yr>0?fmt(yr):"â€”"}</td>
                  </tr>
                );
              })}
              <tr>
                <td style={{fontWeight:700,fontSize:11,letterSpacing:1,color:"var(--text)"}}>TOTAL</td>
                {MONTHS.map(m=>{const mt=regD.reduce((t,d)=>t+sumO(((sales[d.id]||{})[selYear]||{})[m]||{}),0);return<td key={m} style={{textAlign:"center",fontSize:11,fontWeight:600,color:m===selMonth?"var(--gold)":mt>0?"var(--text)":"var(--text3)"}}>{mt>0?fmt(mt):"â€”"}</td>;})}
                <td style={{textAlign:"right",fontWeight:700,color:"var(--gold)"}}>{fmt(regD.reduce((t,d)=>t+MONTHS.reduce((mt,m)=>mt+sumO(((sales[d.id]||{})[selYear]||{})[m]||{}),0),0))}</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  );
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  VIEW: WORK & PAY
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function VWap({wapD,wap,updWap,selYear,selMonth,setSelYear,setSelMonth}){
  if(!wapD.length)return<div className="card empty-state"><div className="empty-ico">ğŸ“‹</div><div style={{fontSize:12,letterSpacing:2}}>NO WORK & PAY DRIVERS</div><div style={{fontSize:11,marginTop:8}}>Add a driver and tick "Work & Pay" in Drivers tab</div></div>;
  return(
    <div>
      <PeriodPicker year={selYear} month={selMonth} setYear={setSelYear} setMonth={setSelMonth} label="PAYMENT PERIOD"/>
      {wapD.map(d=>{
        const totPaid=Object.values(wap[d.id]||{}).reduce((t,yrs)=>t+Object.values(yrs||{}).reduce((yt,wks)=>yt+sumO(wks),0),0);
        const bal=d.wapAmount-totPaid;
        const p=Math.min(100,d.wapAmount>0?(totPaid/d.wapAmount)*100:0);
        const mWks=((wap[d.id]||{})[selYear]||{})[selMonth]||{};
        return(
          <div key={d.id} className="card" style={{marginBottom:12}}>
            <div style={{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:12,flexWrap:"wrap",gap:8}}>
              <div>
                <div style={{display:"flex",alignItems:"center",gap:8,marginBottom:3}}><CDot color={d.color}/><span style={{fontFamily:"var(--fd)",fontWeight:800,fontSize:15}}>{d.name}</span></div>
                <div style={{fontSize:11,color:"var(--text3)"}}>{d.reg} Â· {d.tel}</div>
              </div>
              <div style={{textAlign:"right"}}>
                <div style={{fontSize:9,color:"var(--text3)",letterSpacing:2,marginBottom:3}}>REMAINING</div>
                <div style={{fontSize:20,fontWeight:800,fontFamily:"var(--fd)",color:bal<=0?"var(--green)":"var(--gold)"}}>{fmt(bal)}</div>
                <div style={{fontSize:10,color:"var(--text3)"}}>{fmt(totPaid)} paid of {fmt(d.wapAmount)}</div>
              </div>
            </div>
            <div className="prog-track" style={{marginBottom:16}}><div className="prog-fill" style={{width:`${p}%`}}/></div>
            <div className="sec-title">{selMonth} {selYear} â€” Payments</div>
            <div className="wks-grid" style={{marginBottom:10}}>
              {[1,2,3,4,5].map(w=>(
                <div key={w} className="wk-box">
                  <label>Wk {w}</label>
                  <input type="number" className="wk-inp" value={mWks[w]||""} placeholder="0" onChange={e=>updWap(d.id,selYear,selMonth,w,e.target.value)}/>
                </div>
              ))}
            </div>
            <div style={{textAlign:"right",fontSize:12,color:"var(--gold)",fontWeight:700,marginBottom:16}}>{selMonth} {selYear}: {fmt(sumO(mWks))}</div>
            <div className="sec-title">Payment History</div>
            <div className="tbl-wrap">
              <table>
                <thead><tr><th>Year</th><th>Month</th>{[1,2,3,4,5].map(w=><th key={w} style={{textAlign:"center"}}>Wk{w}</th>)}<th style={{textAlign:"right"}}>Paid</th><th style={{textAlign:"right"}}>Balance</th></tr></thead>
                <tbody>
                  {(()=>{let cum=0;const rows=[];
                    Object.keys(wap[d.id]||{}).sort().forEach(yr=>{
                      MONTHS.forEach(m=>{
                        const mw=((wap[d.id]||{})[yr]||{})[m]||{};
                        const mp=sumO(mw);
                        if(!mp&&!(yr===selYear&&m===selMonth))return;
                        cum+=mp;const cb=d.wapAmount-cum;const isSel=yr===selYear&&m===selMonth;
                        rows.push(<tr key={yr+m} style={{background:isSel?"#f5a62308":""}}>
                          <td style={{fontSize:11,color:isSel?"var(--gold)":"var(--text3)"}}>{yr}</td>
                          <td style={{color:isSel?"var(--gold)":"var(--text2)",fontWeight:isSel?600:400,whiteSpace:"nowrap"}}>{m}</td>
                          {[1,2,3,4,5].map(w=><td key={w} style={{textAlign:"center",fontSize:11,color:"var(--text3)"}}>{mw[w]||"â€”"}</td>)}
                          <td style={{textAlign:"right",color:"var(--text2)",whiteSpace:"nowrap"}}>{mp>0?fmt(mp):"â€”"}</td>
                          <td style={{textAlign:"right",fontWeight:600,color:cb<=0?"var(--green)":"var(--text2)",whiteSpace:"nowrap"}}>{fmt(cb)}</td>
                        </tr>);
                      });
                    });
                    return rows.length?rows:<tr><td colSpan="9" style={{textAlign:"center",color:"var(--text3)",padding:14,fontSize:11}}>No history yet</td></tr>;
                  })()}
                </tbody>
              </table>
            </div>
          </div>
        );
      })}
    </div>
  );
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  VIEW: REPORTS  â† NEW
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function VReports({regD,wapD,drivers,sales,wap,selYear,selMonth,setSelYear,setSelMonth,onExport}){
  const [rTab,setRTab]=useState("monthly");

  // All years that have data
  const allYears=[...new Set(Object.values(sales).flatMap(y=>Object.keys(y||{})))].sort().reverse();
  const displayYears=allYears.length?allYears:[selYear];

  // Monthly totals for selected year
  const monthlyTotals=MONTHS.map(m=>({
    month:m,
    total:regD.reduce((t,d)=>t+sumO(((sales[d.id]||{})[selYear]||{})[m]||{}),0),
  }));
  const maxMthTotal=Math.max(...monthlyTotals.map(x=>x.total),1);

  // Driver totals for selected year
  const driverYearTotals=regD.map(d=>({
    ...d,
    total:MONTHS.reduce((t,m)=>t+sumO(((sales[d.id]||{})[selYear]||{})[m]||{}),0),
    monthTotal:sumO(((sales[d.id]||{})[selYear]||{})[selMonth]||{}),
  })).sort((a,b)=>b.total-a.total);
  const maxDrvTotal=Math.max(...driverYearTotals.map(x=>x.total),1);

  // KPIs
  const yearTotal=monthlyTotals.reduce((t,x)=>t+x.total,0);
  const activeMths=monthlyTotals.filter(x=>x.total>0).length;
  const avgMth=activeMths?Math.round(yearTotal/activeMths):0;
  const bestMth=monthlyTotals.reduce((b,x)=>x.total>b.total?x:b,{month:"â€”",total:0});
  const bestDrv=driverYearTotals[0]||{name:"â€”",total:0};
  const periodSales=regD.reduce((t,d)=>t+sumO(((sales[d.id]||{})[selYear]||{})[selMonth]||{}),0);

  // Prev month comparison
  const mIdx=MONTHS.indexOf(selMonth);
  const prevMth=mIdx>0?MONTHS[mIdx-1]:null;
  const prevMthTotal=prevMth?regD.reduce((t,d)=>t+sumO(((sales[d.id]||{})[selYear]||{})[prevMth]||{}),0):0;
  const mthChange=prevMthTotal>0?((periodSales-prevMthTotal)/prevMthTotal*100).toFixed(1):null;

  // W&P summary
  const wapSummary=wapD.map(d=>{
    const totPaid=Object.values(wap[d.id]||{}).reduce((t,yrs)=>t+Object.values(yrs||{}).reduce((yt,wks)=>yt+sumO(wks),0),0);
    return{...d,totPaid,bal:d.wapAmount-totPaid,pct:d.wapAmount>0?Math.min(100,(totPaid/d.wapAmount)*100):0};
  });

  // Year-over-year
  const yoyRows=displayYears.slice(0,4).map(yr=>({
    yr,total:regD.reduce((t,d)=>t+MONTHS.reduce((mt,m)=>mt+sumO(((sales[d.id]||{})[yr]||{})[m]||{}),0),0),
  }));
  const maxYoy=Math.max(...yoyRows.map(x=>x.total),1);

  const RANK_CLS=["rank-1","rank-2","rank-3","rank-n","rank-n","rank-n"];

  return(
    <div>
      <PeriodPicker year={selYear} month={selMonth} setYear={setSelYear} setMonth={setSelMonth} label="REPORT PERIOD"/>

      {/* Report tabs */}
      <div className="report-tabs">
        {[["monthly","ğŸ“… Monthly"],["drivers","ğŸ‘¤ Drivers"],["yoy","ğŸ“ˆ Year vs Year"],["wap","ğŸ’³ Work & Pay"]].map(([id,lbl])=>(
          <button key={id} className={`report-tab${rTab===id?" active":""}`} onClick={()=>setRTab(id)}>{lbl}</button>
        ))}
      </div>

      {/* â”€â”€ MONTHLY REPORT â”€â”€ */}
      {rTab==="monthly"&&(
        <div>
          {/* KPIs */}
          <div className="kpi-grid">
            <div className="kpi-card">
              <div className="kpi-label">{selYear} Total Sales</div>
              <div className="kpi-val">{fmt(yearTotal)}</div>
              <div className="kpi-sub">{activeMths} active months</div>
            </div>
            <div className="kpi-card">
              <div className="kpi-label">{selMonth} Sales</div>
              <div className="kpi-val">{fmt(periodSales)}</div>
              {mthChange!==null&&<div className={`kpi-sub ${Number(mthChange)>=0?"trend-up":"trend-dn"}`}>{Number(mthChange)>=0?"â–²":"â–¼"} {Math.abs(mthChange)}% vs {prevMth}</div>}
            </div>
            <div className="kpi-card">
              <div className="kpi-label">Avg per Month</div>
              <div className="kpi-val">{fmt(avgMth)}</div>
              <div className="kpi-sub">best: {bestMth.month}</div>
            </div>
          </div>

          {/* Bar chart â€” monthly */}
          <div className="card" style={{marginBottom:14}}>
            <div className="sec-title">{selYear} â€” Monthly Sales Chart</div>
            {monthlyTotals.filter(x=>x.total>0).length===0
              ?<div style={{fontSize:11,color:"var(--text3)",padding:"8px 0"}}>No sales data for {selYear}.</div>
              :monthlyTotals.map((x,i)=>{
                if(!x.total)return null;
                const isSel=x.month===selMonth;
                return(
                  <div key={x.month} className="bar-row">
                    <div className="bar-label" style={{color:isSel?"var(--gold)":"var(--text2)",fontWeight:isSel?700:400}}>{x.month.slice(0,3)}</div>
                    <div className="bar-track">
                      <div className={`bar-fill ${isSel?"rank-1":"rank-n"}`} style={{width:`${pct(x.total,maxMthTotal)}%`}}>
                        <span style={{color:isSel?"#0a0a0f":"#aaa"}}>{fmt(x.total)}</span>
                      </div>
                    </div>
                  </div>
                );
              })
            }
          </div>

          {/* Per-driver breakdown for selected month */}
          <div className="card">
            <div className="sec-title">{selMonth} {selYear} â€” Driver Breakdown</div>
            {regD.length===0?<div style={{fontSize:11,color:"var(--text3)"}}>No drivers added yet.</div>
              :<div className="tbl-wrap">
                <table>
                  <thead><tr><th>Driver</th><th>Color</th>{[1,2,3,4,5].map(w=><th key={w} style={{textAlign:"center"}}>Wk{w}</th>)}<th style={{textAlign:"right"}}>Total</th><th style={{textAlign:"right"}}>Share</th></tr></thead>
                  <tbody>
                    {regD.map(d=>{
                      const wks=((sales[d.id]||{})[selYear]||{})[selMonth]||{};
                      const t=sumO(wks);
                      return(
                        <tr key={d.id}>
                          <td style={{fontWeight:600,color:"var(--text)"}}>{d.name}</td>
                          <td><CBadge color={d.color}/></td>
                          {[1,2,3,4,5].map(w=><td key={w} style={{textAlign:"center",fontSize:11,color:wks[w]>0?"var(--text2)":"var(--text3)"}}>{wks[w]||"â€”"}</td>)}
                          <td style={{textAlign:"right",fontWeight:700,color:t>0?"var(--gold)":"var(--text3)"}}>{t>0?fmt(t):"â€”"}</td>
                          <td style={{textAlign:"right",fontSize:11,color:"var(--text3)"}}>{periodSales>0?`${((t/periodSales)*100).toFixed(0)}%`:"â€”"}</td>
                        </tr>
                      );
                    })}
                  </tbody>
                  <tfoot><tr>
                    <td colSpan="2">TOTAL</td>
                    {[1,2,3,4,5].map(w=>{const wt=regD.reduce((t,d)=>t+(Number(((sales[d.id]||{})[selYear]||{})[selMonth]||{})[w])||0,0);return<td key={w} style={{textAlign:"center",fontWeight:600}}>{wt||"â€”"}</td>;})}
                    <td style={{textAlign:"right",color:"var(--gold)"}}>{fmt(periodSales)}</td>
                    <td style={{textAlign:"right"}}>100%</td>
                  </tr></tfoot>
                </table>
              </div>
            }
          </div>
        </div>
      )}

      {/* â”€â”€ DRIVERS REPORT â”€â”€ */}
      {rTab==="drivers"&&(
        <div>
          <div className="kpi-grid">
            <div className="kpi-card"><div className="kpi-label">Top Driver ({selYear})</div><div className="kpi-val" style={{fontSize:16}}>{bestDrv.name}</div><div className="kpi-sub">{fmt(bestDrv.total)}</div></div>
            <div className="kpi-card"><div className="kpi-label">Total Drivers</div><div className="kpi-val">{regD.length}</div><div className="kpi-sub">{wapD.length} on W&P</div></div>
            <div className="kpi-card"><div className="kpi-label">Avg per Driver ({selYear})</div><div className="kpi-val">{fmt(regD.length?Math.round(yearTotal/regD.length):0)}</div><div className="kpi-sub">this year</div></div>
          </div>
          <div className="card" style={{marginBottom:14}}>
            <div className="sec-title">Driver Performance â€” {selYear}</div>
            {driverYearTotals.length===0?<div style={{fontSize:11,color:"var(--text3)"}}>No drivers yet.</div>
              :driverYearTotals.map((d,i)=>(
              <div key={d.id} className="bar-row">
                <div className="bar-label" style={{display:"flex",alignItems:"center",gap:5}}><CDot color={d.color}/><span style={{fontSize:11}}>{d.name}</span></div>
                <div className="bar-track">
                  <div className={`bar-fill ${RANK_CLS[i]||"rank-n"}`} style={{width:`${pct(d.total,maxDrvTotal)}%`}}>
                    {d.total>0&&<span style={{color:i===0?"#0a0a0f":"#ccc"}}>{fmt(d.total)}</span>}
                  </div>
                </div>
                <div className="bar-val">{d.total>0?fmt(d.total):"â€”"}</div>
              </div>
            ))}
          </div>
          {/* Per driver all-year table */}
          <div className="card">
            <div className="sec-title">Driver Ã— Month Table â€” {selYear}</div>
            <div className="tbl-wrap">
              <table>
                <thead><tr><th>Driver</th>{MONTHS.map(m=><th key={m} style={{textAlign:"center",fontSize:8}}>{m.slice(0,3)}</th>)}<th style={{textAlign:"right"}}>Total</th></tr></thead>
                <tbody>
                  {driverYearTotals.map(d=>(
                    <tr key={d.id}>
                      <td style={{fontWeight:600,whiteSpace:"nowrap"}}><div style={{display:"flex",alignItems:"center",gap:6}}><CDot color={d.color}/>{d.name}</div></td>
                      {MONTHS.map(m=>{const mt=sumO(((sales[d.id]||{})[selYear]||{})[m]||{});return<td key={m} style={{textAlign:"center",fontSize:11,color:m===selMonth?"var(--gold)":mt>0?"var(--text2)":"var(--text3)",background:m===selMonth?"#f5a62308":""}}>{mt>0?mt.toLocaleString():"â€”"}</td>;})}
                      <td style={{textAlign:"right",fontWeight:700,color:d.total>0?"var(--gold)":"var(--text3)"}}>{d.total>0?fmt(d.total):"â€”"}</td>
                    </tr>
                  ))}
                </tbody>
                <tfoot><tr>
                  <td>TOTAL</td>
                  {MONTHS.map(m=>{const mt=regD.reduce((t,d)=>t+sumO(((sales[d.id]||{})[selYear]||{})[m]||{}),0);return<td key={m} style={{textAlign:"center",color:m===selMonth?"var(--gold)":mt>0?"var(--text)":"var(--text3)"}}>{mt>0?fmt(mt):"â€”"}</td>;})}
                  <td style={{textAlign:"right",color:"var(--gold)"}}>{fmt(yearTotal)}</td>
                </tr></tfoot>
              </table>
            </div>
          </div>
        </div>
      )}

      {/* â”€â”€ YEAR OVER YEAR â”€â”€ */}
      {rTab==="yoy"&&(
        <div>
          <div className="card" style={{marginBottom:14}}>
            <div className="sec-title">Year-over-Year Total Sales</div>
            {yoyRows.length===0?<div style={{fontSize:11,color:"var(--text3)"}}>No data yet across years.</div>
              :yoyRows.map((x,i)=>(
              <div key={x.yr} className="bar-row">
                <div className="bar-label" style={{fontWeight:x.yr===selYear?700:400,color:x.yr===selYear?"var(--gold)":"var(--text2)"}}>{x.yr}</div>
                <div className="bar-track">
                  <div className={`bar-fill ${RANK_CLS[i]}`} style={{width:`${pct(x.total,maxYoy)}%`}}>
                    {x.total>0&&<span style={{color:i===0?"#0a0a0f":"#ccc"}}>{fmt(x.total)}</span>}
                  </div>
                </div>
                <div className="bar-val">{x.total>0?fmt(x.total):"â€”"}</div>
              </div>
            ))}
          </div>
          {/* Monthly comparison across years */}
          <div className="card">
            <div className="sec-title">{selMonth} â€” Comparison Across Years</div>
            {displayYears.map((yr,i)=>{
              const t=regD.reduce((tt,d)=>tt+sumO(((sales[d.id]||{})[yr]||{})[selMonth]||{}),0);
              if(!t)return null;
              const max2=Math.max(...displayYears.map(y=>regD.reduce((tt,d)=>tt+sumO(((sales[d.id]||{})[y]||{})[selMonth]||{}),0)),1);
              return(
                <div key={yr} className="bar-row">
                  <div className="bar-label" style={{fontWeight:yr===selYear?700:400,color:yr===selYear?"var(--gold)":"var(--text2)"}}>{yr}</div>
                  <div className="bar-track"><div className={`bar-fill ${RANK_CLS[i]}`} style={{width:`${pct(t,max2)}%`}}><span style={{color:i===0?"#0a0a0f":"#ccc"}}>{fmt(t)}</span></div></div>
                  <div className="bar-val">{fmt(t)}</div>
                </div>
              );
            })}
            {displayYears.every(yr=>!regD.reduce((tt,d)=>tt+sumO(((sales[d.id]||{})[yr]||{})[selMonth]||{}),0))&&<div style={{fontSize:11,color:"var(--text3)"}}>No data for {selMonth} across recorded years.</div>}
          </div>
        </div>
      )}

      {/* â”€â”€ WORK & PAY REPORT â”€â”€ */}
      {rTab==="wap"&&(
        <div>
          {wapSummary.length===0?<div className="card empty-state"><div className="empty-ico">ğŸ“‹</div><div style={{fontSize:12,letterSpacing:2}}>NO W&P DRIVERS</div></div>
          :(
            <>
              <div className="kpi-grid">
                <div className="kpi-card"><div className="kpi-label">Total Owed</div><div className="kpi-val">{fmt(wapSummary.reduce((t,d)=>t+d.wapAmount,0))}</div></div>
                <div className="kpi-card"><div className="kpi-label">Total Paid</div><div className="kpi-val" style={{color:"var(--green)"}}>{fmt(wapSummary.reduce((t,d)=>t+d.totPaid,0))}</div></div>
                <div className="kpi-card"><div className="kpi-label">Remaining</div><div className="kpi-val" style={{color:"var(--red)"}}>{fmt(wapSummary.reduce((t,d)=>t+d.bal,0))}</div></div>
              </div>
              {wapSummary.map(d=>(
                <div key={d.id} className="card" style={{marginBottom:12}}>
                  <div style={{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:10,flexWrap:"wrap",gap:8}}>
                    <div style={{display:"flex",alignItems:"center",gap:8}}><CDot color={d.color}/><span style={{fontFamily:"var(--fd)",fontWeight:700,fontSize:14}}>{d.name}</span></div>
                    <div style={{textAlign:"right"}}>
                      <div style={{fontSize:18,fontWeight:800,color:d.bal<=0?"var(--green)":"var(--gold)",fontFamily:"var(--fd)"}}>{fmt(d.bal)} left</div>
                      <div style={{fontSize:10,color:"var(--text3)"}}>{fmt(d.totPaid)} / {fmt(d.wapAmount)} Â· {d.pct.toFixed(0)}% complete</div>
                    </div>
                  </div>
                  <div className="prog-track" style={{marginBottom:12}}><div className="prog-fill" style={{width:`${d.pct}%`}}/></div>
                  <div style={{display:"grid",gridTemplateColumns:"repeat(4,1fr)",gap:8}}>
                    {Object.keys(wap[d.id]||{}).sort().map(yr=>{
                      const yrPaid=Object.values((wap[d.id]||{})[yr]||{}).reduce((t,wks)=>t+sumO(wks),0);
                      return<div key={yr} style={{background:"var(--bg)",borderRadius:6,padding:"10px 12px",border:"1px solid var(--border)"}}>
                        <div style={{fontSize:9,color:"var(--text3)",letterSpacing:2,marginBottom:3}}>{yr}</div>
                        <div style={{fontSize:13,fontWeight:700,color:"var(--gold)"}}>{fmt(yrPaid)}</div>
                      </div>;
                    })}
                  </div>
                </div>
              ))}
            </>
          )}
        </div>
      )}

      {/* Export button at bottom */}
      <div style={{marginTop:20,padding:"16px 0",borderTop:"1px solid var(--border)",display:"flex",gap:10,alignItems:"center",flexWrap:"wrap"}}>
        <span style={{fontSize:10,color:"var(--text3)",letterSpacing:2}}>EXPORT THIS REPORT</span>
        <button className="btn" onClick={onExport}><Ic name="download" size={13} color="#0a0a0f"/> Download Excel (.xlsx)</button>
      </div>
    </div>
  );
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  VIEW: DATA TRANSFER (Export + Import)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function VTransfer({drivers,sales,wap,session,onExport,onImport}){
  return(
    <div>
      <div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16,marginBottom:16}}>
        {/* Export Card */}
        <div className="card" style={{gridColumn:"1/-1"}}>
          <div className="sec-title">ğŸ“¤ Export Data to Excel</div>
          <p style={{fontSize:12,color:"var(--text2)",lineHeight:1.7,marginBottom:18}}>
            Downloads a complete <strong style={{color:"var(--text)"}}>.xlsx</strong> workbook with 4 sheets:
            <strong style={{color:"var(--gold)"}}> Drivers</strong>,
            <strong style={{color:"var(--gold)"}}> Sales</strong>,
            <strong style={{color:"var(--gold)"}}> {new Date().getFullYear()} Summary</strong>, and
            <strong style={{color:"var(--gold)"}}> Work & Pay</strong>.
            Use this to back up your data, open in Excel/Google Sheets, or share with someone.
          </p>
          <div style={{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap",marginBottom:16}}>
            <span className="chip ok">âœ“ {drivers.length} Drivers</span>
            <span className="chip ok">âœ“ {Object.keys(sales).length} Driver Sales Records</span>
            <span className="chip ok">âœ“ {Object.keys(wap).length} W&P Records</span>
          </div>
          <button className="btn" onClick={onExport}><Ic name="download" size={14} color="#0a0a0f"/> Export to Excel (.xlsx)</button>
        </div>

        {/* Import Card */}
        <div className="card" style={{gridColumn:"1/-1"}}>
          <div className="sec-title">ğŸ“¥ Import Data from Excel</div>
          <p style={{fontSize:12,color:"var(--text2)",lineHeight:1.7,marginBottom:14}}>
            Import a <strong style={{color:"var(--text)"}}>.xlsx</strong> file previously exported from Pragya Manager.
            This will <strong style={{color:"var(--red)"}}>replace</strong> your current data with the file contents.
            Export a backup first if needed.
          </p>
          <div style={{background:"var(--bg)",border:"1px solid var(--border2)",borderRadius:6,padding:"12px 16px",marginBottom:16,fontSize:11,color:"var(--text3)",lineHeight:1.7}}>
            <strong style={{color:"var(--text2)"}}>Required sheets in the file:</strong><br/>
            â€¢ <span style={{color:"var(--gold)"}}>Drivers</span> â€” columns: #, Name, Color, Tel, Tracker, Reg No., Type, W&P Amount<br/>
            â€¢ <span style={{color:"var(--gold)"}}>Sales</span> â€” columns: Driver, Year, Month, Week1â€“5, Month Total<br/>
            â€¢ <span style={{color:"var(--gold)"}}>Work &amp; Pay</span> â€” columns: Driver, Year, Month, Week1â€“5, Month Paid, Cum Paid, Balance
          </div>
          <button className="btn btn-blue" onClick={onImport}><Ic name="upload" size={14}/> Import from Excel</button>
        </div>
      </div>
    </div>
  );
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  IMPORT MODAL
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function ImportModal({onFile,msg,onClose}){
  const ref=useRef();
  const [drag,setDrag]=useState(false);
  function handleDrop(e){
    e.preventDefault();setDrag(false);
    const f=e.dataTransfer.files[0];
    if(f)onFile(f);
  }
  return(
    <div className="modal-ov" onClick={onClose}>
      <div className="modal-box" onClick={e=>e.stopPropagation()}>
        <div className="modal-hdr">
          <div className="modal-title">Import Excel File</div>
          <button onClick={onClose} style={{background:"none",border:"none",cursor:"pointer",color:"var(--text3)",padding:3}}><Ic name="x" size={17}/></button>
        </div>
        {msg&&<div className={`notice ${msg.type==="ok"?"notice-ok":msg.type==="warn"?"notice-warn":"notice-err"}`}>{msg.type==="ok"?"âœ“":"âš "} {msg.text}</div>}
        <div className={`import-zone${drag?" drag":""}`}
          onDragOver={e=>{e.preventDefault();setDrag(true);}}
          onDragLeave={()=>setDrag(false)}
          onDrop={handleDrop}
          onClick={()=>ref.current.click()}>
          <input ref={ref} type="file" accept=".xlsx,.xls" onChange={e=>{if(e.target.files[0])onFile(e.target.files[0]);}}/>
          <div style={{fontSize:36,marginBottom:12}}>ğŸ“‚</div>
          <div style={{fontSize:13,color:"var(--text2)",fontWeight:600,marginBottom:6}}>Drop your .xlsx file here</div>
          <div style={{fontSize:11,color:"var(--text3)"}}>or click to browse</div>
        </div>
        <div style={{marginTop:16,fontSize:10,color:"var(--text3)",lineHeight:1.7}}>
          âš  Import will <strong style={{color:"var(--red)"}}>replace</strong> your current drivers, sales and W&P data.<br/>
          Make sure you export a backup first if needed.
        </div>
        <div className="modal-foot">
          <button className="btn-outline" onClick={onClose}>Cancel</button>
        </div>
      </div>
    </div>
  );
}

// â”€â”€ Driver Modal â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function DrvModal({driver,onSave,onClose}){
  const [f,setF]=useState(driver||{color:"BLACK",name:"",tel:"",tracker:"",reg:"",workAndPay:false,wapAmount:0});
  const sv=(k,v)=>setF(p=>({...p,[k]:v}));
  return(
    <div className="modal-ov" onClick={onClose}>
      <div className="modal-box" onClick={e=>e.stopPropagation()}>
        <div className="modal-hdr">
          <div className="modal-title">{driver?"Edit Driver":"New Driver"}</div>
          <button onClick={onClose} style={{background:"none",border:"none",cursor:"pointer",color:"var(--text3)",padding:3}}><Ic name="x" size={17}/></button>
        </div>
        <div className="modal-grid">
          <div><label className="lbl">Driver Name</label><input className="inp" value={f.name} onChange={e=>sv("name",e.target.value.toUpperCase())} placeholder="JOHN"/></div>
          <div>
            <label className="lbl">Pragya Color</label>
            <select className="sel" style={{width:"100%"}} value={f.color} onChange={e=>sv("color",e.target.value)}>
              {DCOLORS.map(c=><option key={c}>{c}</option>)}
            </select>
          </div>
          <div><label className="lbl">Tel. Number</label><input className="inp" value={f.tel} onChange={e=>sv("tel",e.target.value)} placeholder="0200000000"/></div>
          <div><label className="lbl">Tracker No.</label><input className="inp" value={f.tracker} onChange={e=>sv("tracker",e.target.value)} placeholder="0200000000"/></div>
          <div style={{gridColumn:"1/-1"}}><label className="lbl">Registration No.</label><input className="inp" value={f.reg} onChange={e=>sv("reg",e.target.value.toUpperCase())} placeholder="M-25-AP 000"/></div>
          <div style={{gridColumn:"1/-1",display:"flex",alignItems:"center",gap:10,padding:12,background:"var(--bg)",borderRadius:6,border:"1px solid var(--border)"}}>
            <input type="checkbox" id="wchk" checked={f.workAndPay} onChange={e=>sv("workAndPay",e.target.checked)} style={{accentColor:"var(--gold)",width:15,height:15}}/>
            <label htmlFor="wchk" style={{fontSize:12,cursor:"pointer",color:"var(--text2)"}}>Work &amp; Pay driver</label>
          </div>
          {f.workAndPay&&<div style={{gridColumn:"1/-1"}}><label className="lbl">Total Amount Owed (GHâ‚µ)</label><input className="inp" type="number" value={f.wapAmount} onChange={e=>sv("wapAmount",Number(e.target.value))} placeholder="0"/></div>}
        </div>
        <div className="modal-foot">
          <button className="btn-outline" onClick={onClose}>Cancel</button>
          <button className="btn" onClick={()=>onSave(f)} disabled={!f.name.trim()}>{driver?"Save Changes":"Add Driver"}</button>
        </div>
      </div>
    </div>
  );
}

ReactDOM.createRoot(document.getElementById("root")).render(<App/>);
</script>
</body>
</html>
